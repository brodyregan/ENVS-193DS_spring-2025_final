---
title: "ENVS-193DS Final"
format: html
---

Here is the link to my repository: https://github.com/brodyregan/ENVS-193DS_spring-2025_final

```{r message=FALSE, warning=FALSE} 
## Packages
library(tidyverse) # general use
library(here) # file organization
library(gt) # creating summary tables
library(flextable) # creating summary tables
library(janitor) # cleaning data frames
library(lubridate) 


## Data
sst <- read_csv(here("data", "SST_update2023.csv")) #load SBC data set
```


# Problem 1: 

## a. 
[In part 1, they likely used a simple linear regression. This is because they were examining the relationship between two continuous variables. The variables are distance from head water in km and annual total nitrogen load in kg/yr. The p-value likely tested whether there was a statistically significant linear relationship between the two measured variables.

In part 2, they likely used a one-way Analysis of Variance test to compare average nitrogen load based on multiple sources (categorical). The ANOVA test compares the means of a continuous response variable (nitrogen load) across multiple categorical groups.]

## b. 
[Another test that would beneficial to this analysis would be the Post-hoc comparison. ANOVA tells us that there is at least one group mean that is statistically different from the others, but does not specify which one. A post-hoc comparison would test each group of nitrogen sources indicating which ones have differences clarifying where differences in nitrogen load occur. 

I would also recommend stating summary statistics for respective groups including the mean, standard error, and sample size. This would allow us to understand the magnitude and reliability of the data for each location while providing context for the situation.]

## c. 
[Part 1: The results from this simple linear regression showed that sites farther from the headwaters of the San Joaquin River tended to have higher total nitrogen loads (test statistic = ..., df = ..., p = 0.03, α = ..., sample size =...).

Part 2. The ANOVA comparisons show that average nitrogen loads differed among source types (F = ..., DF = ..., p = 0.02, α = ..., sample size = ..., SS = ...) indicating that source locations plays a role in nutrient pollution levels. The post-hoc test compares each group against each other showing (diff = ..., CI = ..., p = ...)]

# Problem 2:

## a.

```{r cleaning data frame}
sst_clean <- sst |> #create a new clean data frame 
  mutate( #mutate function
    date = ymd(date), #change date column to proper format
    year = year(date), #extract year from the date column
    month = month(date, label = TRUE, abbr = TRUE) #extract moonth from date column but abbreviate each name
  ) |> 
  filter(year >= 2018) |> #only keep years 2018 and more recent
  group_by(year, month) |> #group data by year and month 
  summarize(mean_monthly_sst = mean(temp, na.rm = TRUE), #calculate average SST for each group (year-month)
            .groups = "drop") |>  #ungroup the results are summarizing
  mutate( #mutate function
    year = factor(year), #convert year into a faccot
    month = factor(month, levels = month.abb, ordered = TRUE) #order month from Jan to Dec
  )
```

```{r}

str(sst_clean) #display the structure of the data frame

```

```{r}
slice_sample(sst_clean, n = 5) #display the first 5 rows of the table
```

## b. 

```{r Visualization}
ggplot(data = sst_clean |> mutate(year = as.numeric(as.character(year))),
       aes(x = month,
           y = mean_monthly_sst,
           color = year,
           group = year))+
  geom_point()+
  geom_line()+
  scale_color_gradient(low = "lightblue", high = "black", name = "Year")+
    labs(x = "Month",
         y = "Mean monthly sea surface temperature (°C)",
         color = "Year")+
    theme_minimal()+
    theme(panel.grid = element_blank(),
          panel.background = element_rect(fill = "white", color = "black"))
  

```





